<?xml version="1.0" ?>
<def-group>
  <!--ATTENTION: some OVAL entities defined below ALSO OCCUR in OVAL definitions
for other rules - a mechanism generating SCAP from these sources must ensure that
multiple definitions of the same entity are exactly the same.
When using 'localized' per-rule OVAL, as encouraged by the Scapolite format
it is probaly preferable to structure OVAL differently and work with shared OVAL files.
The OVAL presented here has been exported automatically but no such optimization
using shared OVAL files has been carried out.
Here is the list of identifies for OVAL entities that also occur in other rules:
 - 'oval:ssg-state_rhel_server:ste:1'
- 'oval:ssg-test_rhel_computenode:tst:1'
- 'oval:ssg-sshd_not_required_or_unset:def:1'
- 'oval:ssg-obj_sle11_server:obj:1'
- 'oval:ssg-obj_rpm_openssh-server-version:obj:1'
- 'oval:ssg-sshd_requirement_unset:def:1'
- 'oval:ssg-test_ol8_system:tst:1'
- 'oval:ssg-state_sle11_server:ste:1'
- 'oval:ssg-installed_OS_is_sle11:def:1'
- 'oval:ssg-test_package_openssh-server_installed:tst:1'
- 'oval:ssg-obj_ubuntu_trusty:obj:1'
- 'oval:ssg-state_rhel7_workstation:ste:1'
- 'oval:ssg-test_sle11_desktop:tst:1'
- 'oval:ssg-state_rhel_client:ste:1'
- 'oval:ssg-installed_OS_is_ubuntu1604:def:1'
- 'oval:ssg-installed_OS_is_opensuse:def:1'
- 'oval:ssg-state_rhel7_client:ste:1'
- 'oval:ssg-sshd_required:var:1'
- 'oval:ssg-test_ubuntu_trusty:tst:1'
- 'oval:ssg-obj_rhel_client:obj:1'
- 'oval:ssg-test_fedora_release_rpm:tst:1'
- 'oval:ssg-object_sshd_required:obj:1'
- 'oval:ssg-test_sle12_unix_family:tst:1'
- 'oval:ssg-state_rhevh_rhel_version:ste:1'
- 'oval:ssg-obj_rhel7_server:obj:1'
- 'oval:ssg-state_deb_openssh-server-version:ste:1'
- 'oval:ssg-obj_rhevh_rhel_version:obj:1'
- 'oval:ssg-state_rhel_workstation:ste:1'
- 'oval:ssg-state_opensuse_installed:ste:1'
- 'oval:ssg-test_rhel7_unix_family:tst:1'
- 'oval:ssg-installed_OS_is_centos6:def:1'
- 'oval:ssg-state_sle12_server:ste:1'
- 'oval:ssg-obj_sle11_unix_family:obj:1'
- 'oval:ssg-obj_lsb:obj:1'
- 'oval:ssg-obj_sle12_server:obj:1'
- 'oval:ssg-object_sshd_requirement_unknown:obj:1'
- 'oval:ssg-test_rhel_workstation:tst:1'
- 'oval:ssg-obj_rhel7_unix_family:obj:1'
- 'oval:ssg-installed_OS_is_ubuntu1404:def:1'
- 'oval:ssg-state_sle11_unix_family:ste:1'
- 'oval:ssg-state_sle12_unix_family:ste:1'
- 'oval:ssg-state_centos6:ste:1'
- 'oval:ssg-test_rhel7_client:tst:1'
- 'oval:ssg-test_deb_openssh-server_version:tst:1'
- 'oval:ssg-object_sshd_not_required:obj:1'
- 'oval:ssg-test_opensuse_installed:tst:1'
- 'oval:ssg-test_sshd_not_required:tst:1'
- 'oval:ssg-obj_package_openssh-server_installed:obj:1'
- 'oval:ssg-installed_OS_is_ol7_family:def:1'
- 'oval:ssg-object_fedora_vendor_product:obj:1'
- 'oval:ssg-state_ol8_system:ste:1'
- 'oval:ssg-obj_sle11_desktop:obj:1'
- 'oval:ssg-installed_OS_is_part_of_Unix_family:def:1'
- 'oval:ssg-state_sshd_not_required:ste:1'
- 'oval:ssg-test_unix_family:tst:1'
- 'oval:ssg-installed_OS_is_debian8:def:1'
- 'oval:ssg-state_rhel_computenode:ste:1'
- 'oval:ssg-test_centos7:tst:1'
- 'oval:ssg-installed_OS_is_ubuntu1804:def:1'
- 'oval:ssg-obj_deb_openssh-server-version:obj:1'
- 'oval:ssg-test_rpm_openssh-server_version:tst:1'
- 'oval:ssg-obj_ol7_system:obj:1'
- 'oval:ssg-obj_centos6:obj:1'
- 'oval:ssg-test_rhel_server:tst:1'
- 'oval:ssg-state_centos7:ste:1'
- 'oval:ssg-installed_OS_is_sle12:def:1'
- 'oval:ssg-test_sle12_server:tst:1'
- 'oval:ssg-obj_rhel7_computenode:obj:1'
- 'oval:ssg-test_redhat_release_virtualization_host_rpm:tst:1'
- 'oval:ssg-obj_rhel7_client:obj:1'
- 'oval:ssg-test_sshd_requirement_unset:tst:1'
- 'oval:ssg-test_debian:tst:1'
- 'oval:ssg-state_sshd_required:ste:1'
- 'oval:ssg-state_rhel7_server:ste:1'
- 'oval:ssg-test_sshd_required:tst:1'
- 'oval:ssg-installed_OS_is_centos7:def:1'
- 'oval:ssg-test_centos6:tst:1'
- 'oval:ssg-obj_sle12_desktop:obj:1'
- 'oval:ssg-test_rhel7_server:tst:1'
- 'oval:ssg-test_fedora_vendor_product:tst:1'
- 'oval:ssg-installed_OS_is_fedora:def:1'
- 'oval:ssg-installed_OS_is_ol8_family:def:1'
- 'oval:ssg-obj_ol8_system:obj:1'
- 'oval:ssg-obj_ubuntu_xenial:obj:1'
- 'oval:ssg-test_ubuntu_bionic:tst:1'
- 'oval:ssg-obj_ubuntu_bionic:obj:1'
- 'oval:ssg-object_unix_family:obj:1'
- 'oval:ssg-obj_package_openssh-server_removed:obj:1'
- 'oval:ssg-state_rhel7_computenode:ste:1'
- 'oval:ssg-obj_sle12_unix_family:obj:1'
- 'oval:ssg-test_rhev_rhel_version:tst:1'
- 'oval:ssg-installed_OS_is_rhel6:def:1'
- 'oval:ssg-test_rhel7_workstation:tst:1'
- 'oval:ssg-obj_rhel_computenode:obj:1'
- 'oval:ssg-obj_rhel_server:obj:1'
- 'oval:ssg-test_lsb:tst:1'
- 'oval:ssg-obj_opensuse_installed:obj:1'
- 'oval:ssg-obj_redhat_release_virtualization_host_rpm:obj:1'
- 'oval:ssg-installed_OS_is_ubuntu:def:1'
- 'oval:ssg-installed_OS_is_rhel7:def:1'
- 'oval:ssg-sshd_required_or_unset:def:1'
- 'oval:ssg-obj_debian:obj:1'
- 'oval:ssg-obj_centos7:obj:1'
- 'oval:ssg-state_ol7_system:ste:1'
- 'oval:ssg-state_rhel7_unix_family:ste:1'
- 'oval:ssg-sshd_version_equal_or_higher_than_74:def:1'
- 'oval:ssg-test_ubuntu_xenial:tst:1'
- 'oval:ssg-state_sshd_requirement_unset:ste:1'
- 'oval:ssg-test_ol7_system:tst:1'
- 'oval:ssg-test_sle11_server:tst:1'
- 'oval:ssg-test_ubuntu:tst:1'
- 'oval:ssg-package_openssh-server_removed:def:1'
- 'oval:ssg-test_sle11_unix_family:tst:1'
- 'oval:ssg-package_openssh-server_installed:def:1'
- 'oval:ssg-test_rhel7_computenode:tst:1'
- 'oval:ssg-test_package_openssh-server_removed:tst:1'
- 'oval:ssg-object_fedora_release_rpm:obj:1'
- 'oval:ssg-obj_ubuntu:obj:1'
- 'oval:ssg-test_debian_8:tst:1'
- 'oval:ssg-state_sle12_desktop:ste:1'
- 'oval:ssg-test_sle12_desktop:tst:1'
- 'oval:ssg-obj_rhel7_workstation:obj:1'
- 'oval:ssg-state_rpm_openssh-server-version:ste:1'
- 'oval:ssg-test_rhel_client:tst:1'
- 'oval:ssg-obj_debian_8:obj:1'
- 'oval:ssg-state_unix_family:ste:1'
- 'oval:ssg-obj_rhel_workstation:obj:1'
- 'oval:ssg-state_sle11_desktop:ste:1'  -->
  <definition class="compliance" id="oval:ssg-sshd_disable_rhosts_rsa:def:1" version="1">
    <metadata>
      <title>Disable SSH Support for Rhosts RSA Authentication</title>
      <affected family="unix">
        <platform>Red Hat Enterprise Linux 8</platform>
      </affected>
      <description>SSH can allow authentication through the obsolete rsh command
      through the use of the authenticating user's SSH keys. This should be disabled.</description>
      <reference ref_id="CCE-80900-4" source="CCE"/>
      <reference ref_id="sshd_disable_rhosts_rsa" source="ssg"/>
    </metadata>
    <criteria comment="SSH is configured correctly or is not installed" operator="OR">
      <criteria comment="sshd is not installed" operator="AND">
        <extend_definition comment="sshd is not required or requirement is unset" definition_ref="oval:ssg-sshd_not_required_or_unset:def:1"/>
        <extend_definition comment="rpm package openssh-server removed" definition_ref="oval:ssg-package_openssh-server_removed:def:1"/>
      </criteria>
      <criteria comment="sshd is installed and configured" operator="AND">
        <extend_definition comment="sshd is required or requirement is unset" definition_ref="oval:ssg-sshd_required_or_unset:def:1"/>
        <extend_definition comment="rpm package openssh-server installed" definition_ref="oval:ssg-package_openssh-server_installed:def:1"/>
        <criteria comment="SSH version is equal or higher than 7.4 has deprecated RhostsRSAAuthentication" operator="OR">
          <extend_definition comment="OpenSSH version 7.4 or higher has deprecated RhostsRSAAuthentication" definition_ref="oval:ssg-sshd_version_equal_or_higher_than_74:def:1"/>
          <criterion comment="Check RhostsRSAAuthentication in /etc/ssh/sshd_config" negate="true" test_ref="oval:ssg-test_sshd_disable_rhosts_rsa:tst:1"/>
        </criteria>
      </criteria>
    </criteria>
  </definition>
  <linux:rpminfo_state id="oval:ssg-state_rhel_server:ste:1" version="1">
    <linux:version operation="pattern match">^6.*$</linux:version>
  </linux:rpminfo_state>
  <linux:rpminfo_test check="all" check_existence="at_least_one_exists" comment="redhat-release-computenode is version 6" id="oval:ssg-test_rhel_computenode:tst:1" version="1">
    <linux:object object_ref="oval:ssg-obj_rhel_computenode:obj:1"/>
    <linux:state state_ref="oval:ssg-state_rhel_computenode:ste:1"/>
  </linux:rpminfo_test>
  <definition class="compliance" id="oval:ssg-sshd_not_required_or_unset:def:1" version="1">
    <metadata>
      <title>SSHD is not required to be installed or requirement not set</title>
      <affected family="unix">
        <platform>Red Hat Enterprise Linux 8</platform>
      </affected>
      <description>If SSHD is not required, we check it is not installed. If SSH requirement is unset, we are good.</description>
      <reference ref_id="sshd_not_required_or_unset" source="ssg"/>
    </metadata>
    <criteria comment="SSH not required or not set" operator="OR">
      <criterion test_ref="oval:ssg-test_sshd_not_required:tst:1"/>
      <extend_definition comment="SSH requirement is unset" definition_ref="oval:ssg-sshd_requirement_unset:def:1"/>
    </criteria>
  </definition>
  <linux:rpminfo_object id="oval:ssg-obj_sle11_server:obj:1" version="1">
    <linux:name>sles-release</linux:name>
  </linux:rpminfo_object>
  <linux:rpminfo_object id="oval:ssg-obj_rpm_openssh-server-version:obj:1" version="1">
    <linux:name>openssh-server</linux:name>
  </linux:rpminfo_object>
  <definition class="compliance" id="oval:ssg-sshd_requirement_unset:def:1" version="1">
    <metadata>
      <title>It doesn't matter if sshd is installed or not</title>
      <affected family="unix">
        <platform>Red Hat Enterprise Linux 8</platform>
      </affected>
      <description>Test if value sshd_required is 0.</description>
      <reference ref_id="sshd_requirement_unset" source="ssg"/>
    </metadata>
    <criteria operator="AND">
      <criterion test_ref="oval:ssg-test_sshd_requirement_unset:tst:1"/>
    </criteria>
  </definition>
  <linux:rpminfo_test check="all" check_existence="at_least_one_exists" comment="oraclelinux-release is version 8" id="oval:ssg-test_ol8_system:tst:1" version="1">
    <linux:object object_ref="oval:ssg-obj_ol8_system:obj:1"/>
    <linux:state state_ref="oval:ssg-state_ol8_system:ste:1"/>
  </linux:rpminfo_test>
  <linux:rpminfo_state id="oval:ssg-state_sle11_server:ste:1" version="1">
    <linux:version operation="pattern match">^11.*$</linux:version>
  </linux:rpminfo_state>
  <ind:textfilecontent54_object id="oval:ssg-obj_sshd_disable_rhosts_rsa:obj:1" version="2">
    <ind:filepath>/etc/ssh/sshd_config</ind:filepath>
    <ind:pattern operation="pattern match">^[\s]*(?i)RhostsRSAAuthentication(?-i)[\s]+no[\s]*(?:|(?:#.*))?$</ind:pattern>
    <ind:instance datatype="int">1</ind:instance>
  </ind:textfilecontent54_object>
  <definition class="inventory" id="oval:ssg-installed_OS_is_sle11:def:1" version="1">
    <metadata>
      <title>SUSE Linux Enterprise 11</title>
      <affected family="unix">
        <platform>Red Hat Enterprise Linux 8</platform>
      </affected>
      <reference ref_id="cpe:/o:suse:linux_enterprise_server:11" source="CPE"/>
      <reference ref_id="cpe:/o:suse:linux_enterprise_desktop:11" source="CPE"/>
      <description>The operating system installed on the system is
      SUSE Linux Enterprise 11.</description>
      <reference ref_id="installed_OS_is_sle11" source="ssg"/>
    </metadata>
    <criteria>
      <criterion comment="Installed operating system is part of the unix family" test_ref="oval:ssg-test_sle11_unix_family:tst:1"/>
      <criteria operator="OR">
        <criterion comment="SLE 11 Desktop is installed" test_ref="oval:ssg-test_sle11_desktop:tst:1"/>
        <criterion comment="SLE 11 Server is installed" test_ref="oval:ssg-test_sle11_server:tst:1"/>
      </criteria>
    </criteria>
  </definition>
  <linux:rpminfo_test check="all" check_existence="all_exist" comment="package openssh-server is installed" id="oval:ssg-test_package_openssh-server_installed:tst:1" version="1">
    <linux:object object_ref="oval:ssg-obj_package_openssh-server_installed:obj:1"/>
  </linux:rpminfo_test>
  <ind:textfilecontent54_object comment="Check Ubuntu version" id="oval:ssg-obj_ubuntu_trusty:obj:1" version="1">
    <ind:filepath>/etc/lsb-release</ind:filepath>
    <ind:pattern operation="pattern match">^DISTRIB_CODENAME=trusty$</ind:pattern>
    <ind:instance datatype="int">1</ind:instance>
  </ind:textfilecontent54_object>
  <linux:rpminfo_state id="oval:ssg-state_rhel7_workstation:ste:1" version="1">
    <linux:version operation="pattern match">^7.*$</linux:version>
  </linux:rpminfo_state>
  <linux:rpminfo_test check="all" check_existence="at_least_one_exists" comment="sled-release is version 6" id="oval:ssg-test_sle11_desktop:tst:1" version="1">
    <linux:object object_ref="oval:ssg-obj_sle11_desktop:obj:1"/>
    <linux:state state_ref="oval:ssg-state_sle11_desktop:ste:1"/>
  </linux:rpminfo_test>
  <linux:rpminfo_state id="oval:ssg-state_rhel_client:ste:1" version="1">
    <linux:version operation="pattern match">^6.*$</linux:version>
  </linux:rpminfo_state>
  <ind:textfilecontent54_test check="all" check_existence="none_exist" comment="Tests the value of the RhostsRSAAuthentication[\s]*(&lt;:nocomment:&gt;*) setting in the /etc/ssh/sshd_config file" id="oval:ssg-test_sshd_disable_rhosts_rsa:tst:1" version="1">
    <ind:object object_ref="oval:ssg-obj_sshd_disable_rhosts_rsa:obj:1"/>
  </ind:textfilecontent54_test>
  <definition class="inventory" id="oval:ssg-installed_OS_is_ubuntu1604:def:1" version="1">
    <metadata>
      <title>Ubuntu 1604</title>
      <affected family="unix">
        <platform>Red Hat Enterprise Linux 8</platform>
      </affected>
      <reference ref_id="cpe:/o:canonical:ubuntu_linux:16.04" source="CPE"/>
      <description>The operating system installed on the system is Ubuntu 1604</description>
      <reference ref_id="installed_OS_is_ubuntu1604" source="ssg"/>
    </metadata>
    <criteria comment="current Ubuntu version is Xenial" operator="AND">
      <extend_definition comment="Ubuntu is installed" definition_ref="oval:ssg-installed_OS_is_ubuntu:def:1"/>
      <criterion comment="Xenial is installed" test_ref="oval:ssg-test_ubuntu_xenial:tst:1"/>
    </criteria>
  </definition>
  <definition class="inventory" id="oval:ssg-installed_OS_is_opensuse:def:1" version="1">
    <metadata>
      <title>openSUSE</title>
      <affected family="unix">
        <platform>Red Hat Enterprise Linux 8</platform>
      </affected>
      <description>The operating system installed on the system is openSUSE.</description>
      <reference ref_id="installed_OS_is_opensuse" source="ssg"/>
    </metadata>
    <criteria operator="AND">
      <extend_definition comment="Installed OS is part of the Unix family" definition_ref="oval:ssg-installed_OS_is_part_of_Unix_family:def:1"/>
      <criterion comment="openSUSE is installed" test_ref="oval:ssg-test_opensuse_installed:tst:1"/>
    </criteria>
  </definition>
  <linux:rpminfo_state id="oval:ssg-state_rhel7_client:ste:1" version="1">
    <linux:version operation="pattern match">^7.*$</linux:version>
  </linux:rpminfo_state>
  <external_variable comment="May be defined by Profiles to explicitly say if sshd is required or not" datatype="int" id="oval:ssg-sshd_required:var:1" version="1"/>
  <ind:textfilecontent54_test check="all" check_existence="at_least_one_exists" comment="Check Ubuntu version" id="oval:ssg-test_ubuntu_trusty:tst:1" version="1">
    <ind:object object_ref="oval:ssg-obj_ubuntu_trusty:obj:1"/>
  </ind:textfilecontent54_test>
  <linux:rpminfo_object id="oval:ssg-obj_rhel_client:obj:1" version="1">
    <linux:name>redhat-release-client</linux:name>
  </linux:rpminfo_object>
  <linux:rpminfo_test check="all" check_existence="at_least_one_exists" comment="fedora-release RPM packages are installed" id="oval:ssg-test_fedora_release_rpm:tst:1" version="1">
    <linux:object object_ref="oval:ssg-object_fedora_release_rpm:obj:1"/>
  </linux:rpminfo_test>
  <ind:variable_object id="oval:ssg-object_sshd_required:obj:1" version="1">
    <ind:var_ref>oval:ssg-sshd_required:var:1</ind:var_ref>
  </ind:variable_object>
  <ind:family_test check="all" check_existence="at_least_one_exists" comment="installed OS part of unix family" id="oval:ssg-test_sle12_unix_family:tst:1" version="1">
    <ind:object object_ref="oval:ssg-obj_sle12_unix_family:obj:1"/>
    <ind:state state_ref="oval:ssg-state_sle12_unix_family:ste:1"/>
  </ind:family_test>
  <ind:textfilecontent54_state id="oval:ssg-state_rhevh_rhel_version:ste:1" version="1">
    <ind:subexpression operation="pattern match">7</ind:subexpression>
  </ind:textfilecontent54_state>
  <linux:rpminfo_object id="oval:ssg-obj_rhel7_server:obj:1" version="1">
    <linux:name>redhat-release-server</linux:name>
  </linux:rpminfo_object>
  <linux:dpkginfo_state id="oval:ssg-state_deb_openssh-server-version:ste:1" version="1">
    <linux:evr datatype="evr_string" operation="greater than or equal">0:7.4</linux:evr>
  </linux:dpkginfo_state>
  <ind:textfilecontent54_object id="oval:ssg-obj_rhevh_rhel_version:obj:1" version="1">
    <ind:filepath>/etc/redhat-release</ind:filepath>
    <ind:pattern operation="pattern match">^Red Hat Enterprise Linux release (\d)\.\d+$</ind:pattern>
    <ind:instance datatype="int" operation="greater than or equal">1</ind:instance>
  </ind:textfilecontent54_object>
  <linux:rpminfo_state id="oval:ssg-state_rhel_workstation:ste:1" version="1">
    <linux:version operation="pattern match">^6.*$</linux:version>
  </linux:rpminfo_state>
  <linux:rpminfo_state id="oval:ssg-state_opensuse_installed:ste:1" version="1">
    <linux:name operation="pattern match">openSUSE-release</linux:name>
  </linux:rpminfo_state>
  <ind:family_test check="all" check_existence="at_least_one_exists" comment="installed OS part of unix family" id="oval:ssg-test_rhel7_unix_family:tst:1" version="1">
    <ind:object object_ref="oval:ssg-obj_rhel7_unix_family:obj:1"/>
    <ind:state state_ref="oval:ssg-state_rhel7_unix_family:ste:1"/>
  </ind:family_test>
  <definition class="inventory" id="oval:ssg-installed_OS_is_centos6:def:1" version="2">
    <metadata>
      <title>CentOS 6</title>
      <affected family="unix">
        <platform>Red Hat Enterprise Linux 8</platform>
      </affected>
      <reference ref_id="cpe:/o:centos:centos:6" source="CPE"/>
      <description>The operating system installed on the system is
      CentOS 6</description>
      <reference ref_id="installed_OS_is_centos6" source="ssg"/>
    </metadata>
    <criteria>
      <extend_definition comment="Installed OS is part of the Unix family" definition_ref="oval:ssg-installed_OS_is_part_of_Unix_family:def:1"/>
      <criterion comment="CentOS6 is installed" test_ref="oval:ssg-test_centos6:tst:1"/>
    </criteria>
  </definition>
  <linux:rpminfo_state id="oval:ssg-state_sle12_server:ste:1" version="1">
    <linux:version operation="pattern match">^12.*$</linux:version>
  </linux:rpminfo_state>
  <ind:family_object id="oval:ssg-obj_sle11_unix_family:obj:1" version="1"/>
  <unix:file_object comment="check /etc/lsb-release file" id="oval:ssg-obj_lsb:obj:1" version="1">
    <unix:filepath>/etc/lsb-release</unix:filepath>
  </unix:file_object>
  <linux:rpminfo_object id="oval:ssg-obj_sle12_server:obj:1" version="1">
    <linux:name>sles-release</linux:name>
  </linux:rpminfo_object>
  <ind:variable_object id="oval:ssg-object_sshd_requirement_unknown:obj:1" version="1">
    <ind:var_ref>oval:ssg-sshd_required:var:1</ind:var_ref>
  </ind:variable_object>
  <linux:rpminfo_test check="all" check_existence="at_least_one_exists" comment="redhat-release-workstation is version 6" id="oval:ssg-test_rhel_workstation:tst:1" version="1">
    <linux:object object_ref="oval:ssg-obj_rhel_workstation:obj:1"/>
    <linux:state state_ref="oval:ssg-state_rhel_workstation:ste:1"/>
  </linux:rpminfo_test>
  <ind:family_object id="oval:ssg-obj_rhel7_unix_family:obj:1" version="1"/>
  <definition class="inventory" id="oval:ssg-installed_OS_is_ubuntu1404:def:1" version="1">
    <metadata>
      <title>Ubuntu 1404</title>
      <affected family="unix">
        <platform>Red Hat Enterprise Linux 8</platform>
      </affected>
      <reference ref_id="cpe:/o:canonical:ubuntu_linux:14.04" source="CPE"/>
      <description>The operating system installed on the system is Ubuntu 1404</description>
      <reference ref_id="installed_OS_is_ubuntu1404" source="ssg"/>
    </metadata>
    <criteria comment="current Ubuntu version is Trusty" operator="AND">
      <extend_definition comment="Ubuntu is installed" definition_ref="oval:ssg-installed_OS_is_ubuntu:def:1"/>
      <criterion comment="Trusty is installed" test_ref="oval:ssg-test_ubuntu_trusty:tst:1"/>
    </criteria>
  </definition>
  <ind:family_state id="oval:ssg-state_sle11_unix_family:ste:1" version="1">
    <ind:family>unix</ind:family>
  </ind:family_state>
  <ind:family_state id="oval:ssg-state_sle12_unix_family:ste:1" version="1">
    <ind:family>unix</ind:family>
  </ind:family_state>
  <linux:rpminfo_state id="oval:ssg-state_centos6:ste:1" version="1">
    <linux:version operation="pattern match">^6.*$</linux:version>
  </linux:rpminfo_state>
  <linux:rpminfo_test check="all" check_existence="at_least_one_exists" comment="redhat-release-client is version 7" id="oval:ssg-test_rhel7_client:tst:1" version="1">
    <linux:object object_ref="oval:ssg-obj_rhel7_client:obj:1"/>
    <linux:state state_ref="oval:ssg-state_rhel7_client:ste:1"/>
  </linux:rpminfo_test>
  <linux:dpkginfo_test check="at least one" check_existence="any_exist" comment="OpenSSH is version 7.4 or higher" id="oval:ssg-test_deb_openssh-server_version:tst:1" version="1">
    <linux:object object_ref="oval:ssg-obj_deb_openssh-server-version:obj:1"/>
    <linux:state state_ref="oval:ssg-state_deb_openssh-server-version:ste:1"/>
  </linux:dpkginfo_test>
  <ind:variable_object id="oval:ssg-object_sshd_not_required:obj:1" version="1">
    <ind:var_ref>oval:ssg-sshd_required:var:1</ind:var_ref>
  </ind:variable_object>
  <linux:rpminfo_test check="all" check_existence="at_least_one_exists" comment="openSUSE is installed" id="oval:ssg-test_opensuse_installed:tst:1" version="1">
    <linux:object object_ref="oval:ssg-obj_opensuse_installed:obj:1"/>
    <linux:state state_ref="oval:ssg-state_opensuse_installed:ste:1"/>
  </linux:rpminfo_test>
  <ind:variable_test check="all" check_existence="at_least_one_exists" comment="Verify if Profile set Value sshd_required as not required" id="oval:ssg-test_sshd_not_required:tst:1" version="1">
    <ind:object object_ref="oval:ssg-object_sshd_not_required:obj:1"/>
    <ind:state state_ref="oval:ssg-state_sshd_not_required:ste:1"/>
  </ind:variable_test>
  <linux:rpminfo_object id="oval:ssg-obj_package_openssh-server_installed:obj:1" version="1">
    <linux:name>openssh-server</linux:name>
  </linux:rpminfo_object>
  <definition class="inventory" id="oval:ssg-installed_OS_is_ol7_family:def:1" version="1">
    <metadata>
      <title>Oracle Linux 7</title>
      <affected family="unix">
        <platform>Red Hat Enterprise Linux 8</platform>
      </affected>
      <reference ref_id="cpe:/o:oracle:linux:7" source="CPE"/>
      <description>The operating system installed on the system is
      Oracle Linux 7</description>
      <reference ref_id="installed_OS_is_ol7_family" source="ssg"/>
    </metadata>
    <criteria>
      <extend_definition comment="Installed OS is part of the Unix family" definition_ref="oval:ssg-installed_OS_is_part_of_Unix_family:def:1"/>
      <criteria operator="OR">
        <criterion comment="Oracle Linux 7 System is installed" test_ref="oval:ssg-test_ol7_system:tst:1"/>
      </criteria>
    </criteria>
  </definition>
  <ind:textfilecontent54_object id="oval:ssg-object_fedora_vendor_product:obj:1" version="1">
    <ind:filepath>/etc/system-release-cpe</ind:filepath>
    <ind:pattern operation="pattern match">^cpe:\/o:fedoraproject:fedora:[\d]+$</ind:pattern>
    <ind:instance datatype="int" operation="equals">1</ind:instance>
  </ind:textfilecontent54_object>
  <linux:rpminfo_state id="oval:ssg-state_ol8_system:ste:1" version="1">
    <linux:version operation="pattern match">^8.*$</linux:version>
  </linux:rpminfo_state>
  <linux:rpminfo_object id="oval:ssg-obj_sle11_desktop:obj:1" version="1">
    <linux:name>sled-release</linux:name>
  </linux:rpminfo_object>
  <definition class="inventory" id="oval:ssg-installed_OS_is_part_of_Unix_family:def:1" version="1">
    <metadata>
      <title>Installed operating system is part of the Unix family</title>
      <affected family="unix">
        <platform>Red Hat Enterprise Linux 8</platform>
      </affected>
      <description>The operating system installed on the system is part of the Unix OS family</description>
      <reference ref_id="installed_OS_is_part_of_Unix_family" source="ssg"/>
    </metadata>
    <criteria>
      <criterion comment="Installed operating system is part of the unix family" test_ref="oval:ssg-test_unix_family:tst:1"/>
    </criteria>
  </definition>
  <ind:variable_state id="oval:ssg-state_sshd_not_required:ste:1" version="1">
    <ind:value datatype="int" operation="equals">1</ind:value>
  </ind:variable_state>
  <ind:family_test check="all" check_existence="at_least_one_exists" comment="Test installed OS is part of the unix family" id="oval:ssg-test_unix_family:tst:1" version="1">
    <ind:object object_ref="oval:ssg-object_unix_family:obj:1"/>
    <ind:state state_ref="oval:ssg-state_unix_family:ste:1"/>
  </ind:family_test>
  <definition class="inventory" id="oval:ssg-installed_OS_is_debian8:def:1" version="3">
    <metadata>
      <title>Debian 8</title>
      <affected family="unix">
        <platform>Red Hat Enterprise Linux 8</platform>
      </affected>
      <reference ref_id="cpe:/o:debian:debian_linux:8" source="CPE"/>
      <description>The operating system installed on the system is Debian 8</description>
      <reference ref_id="installed_OS_is_debian8" source="ssg"/>
    </metadata>
    <criteria comment="current Debian version is Debian jessie" operator="AND">
      <extend_definition comment="Installed OS is part of the Unix family" definition_ref="oval:ssg-installed_OS_is_part_of_Unix_family:def:1"/>
      <criterion comment="Debian is installed" test_ref="oval:ssg-test_debian:tst:1"/>
      <criterion comment="Debian8 is installed" test_ref="oval:ssg-test_debian_8:tst:1"/>
    </criteria>
  </definition>
  <linux:rpminfo_state id="oval:ssg-state_rhel_computenode:ste:1" version="1">
    <linux:version operation="pattern match">^6.*$</linux:version>
  </linux:rpminfo_state>
  <linux:rpminfo_test check="all" check_existence="at_least_one_exists" comment="centos-release is version 7" id="oval:ssg-test_centos7:tst:1" version="1">
    <linux:object object_ref="oval:ssg-obj_centos7:obj:1"/>
    <linux:state state_ref="oval:ssg-state_centos7:ste:1"/>
  </linux:rpminfo_test>
  <definition class="inventory" id="oval:ssg-installed_OS_is_ubuntu1804:def:1" version="1">
    <metadata>
      <title>Ubuntu 1804</title>
      <affected family="unix">
        <platform>Red Hat Enterprise Linux 8</platform>
      </affected>
      <reference ref_id="cpe:/o:canonical:ubuntu_linux:18.04" source="CPE"/>
      <description>The operating system installed on the system is Ubuntu 1804</description>
      <reference ref_id="installed_OS_is_ubuntu1804" source="ssg"/>
    </metadata>
    <criteria comment="current Ubuntu version is Bionic" operator="AND">
      <extend_definition comment="Ubuntu is installed" definition_ref="oval:ssg-installed_OS_is_ubuntu:def:1"/>
      <criterion comment="Bionic is installed" test_ref="oval:ssg-test_ubuntu_bionic:tst:1"/>
    </criteria>
  </definition>
  <linux:dpkginfo_object id="oval:ssg-obj_deb_openssh-server-version:obj:1" version="1">
    <linux:name>openssh-server</linux:name>
  </linux:dpkginfo_object>
  <linux:rpminfo_test check="all" check_existence="at_least_one_exists" comment="OpenSSH is version 7.4 or higher" id="oval:ssg-test_rpm_openssh-server_version:tst:1" version="1">
    <linux:object object_ref="oval:ssg-obj_rpm_openssh-server-version:obj:1"/>
    <linux:state state_ref="oval:ssg-state_rpm_openssh-server-version:ste:1"/>
  </linux:rpminfo_test>
  <linux:rpminfo_object id="oval:ssg-obj_ol7_system:obj:1" version="1">
    <linux:name>oraclelinux-release</linux:name>
  </linux:rpminfo_object>
  <linux:rpminfo_object id="oval:ssg-obj_centos6:obj:1" version="1">
    <linux:name>centos-release</linux:name>
  </linux:rpminfo_object>
  <linux:rpminfo_test check="all" check_existence="at_least_one_exists" comment="redhat-release-server is version 6" id="oval:ssg-test_rhel_server:tst:1" version="1">
    <linux:object object_ref="oval:ssg-obj_rhel_server:obj:1"/>
    <linux:state state_ref="oval:ssg-state_rhel_server:ste:1"/>
  </linux:rpminfo_test>
  <linux:rpminfo_state id="oval:ssg-state_centos7:ste:1" version="1">
    <linux:version operation="pattern match">^7.*$</linux:version>
  </linux:rpminfo_state>
  <definition class="inventory" id="oval:ssg-installed_OS_is_sle12:def:1" version="1">
    <metadata>
      <title>SUSE Linux Enterprise 12</title>
      <affected family="unix">
        <platform>Red Hat Enterprise Linux 8</platform>
      </affected>
      <reference ref_id="cpe:/o:suse:linux_enterprise_server:12" source="CPE"/>
      <reference ref_id="cpe:/o:suse:linux_enterprise_desktop:12" source="CPE"/>
      <description>The operating system installed on the system is
      SUSE Linux Enterprise 12.</description>
      <reference ref_id="installed_OS_is_sle12" source="ssg"/>
    </metadata>
    <criteria>
      <criterion comment="Installed operating system is part of the unix family" test_ref="oval:ssg-test_sle12_unix_family:tst:1"/>
      <criteria operator="OR">
        <criterion comment="SLE 12 Desktop is installed" test_ref="oval:ssg-test_sle12_desktop:tst:1"/>
        <criterion comment="SLE 12 Server is installed" test_ref="oval:ssg-test_sle12_server:tst:1"/>
      </criteria>
    </criteria>
  </definition>
  <linux:rpminfo_test check="all" check_existence="at_least_one_exists" comment="sles-release is version 6" id="oval:ssg-test_sle12_server:tst:1" version="1">
    <linux:object object_ref="oval:ssg-obj_sle12_server:obj:1"/>
    <linux:state state_ref="oval:ssg-state_sle12_server:ste:1"/>
  </linux:rpminfo_test>
  <linux:rpminfo_object id="oval:ssg-obj_rhel7_computenode:obj:1" version="1">
    <linux:name>redhat-release-computenode</linux:name>
  </linux:rpminfo_object>
  <linux:rpminfo_test check="all" check_existence="only_one_exists" comment="redhat-release-virtualization-host RPM package is installed" id="oval:ssg-test_redhat_release_virtualization_host_rpm:tst:1" version="1">
    <linux:object object_ref="oval:ssg-obj_redhat_release_virtualization_host_rpm:obj:1"/>
  </linux:rpminfo_test>
  <linux:rpminfo_object id="oval:ssg-obj_rhel7_client:obj:1" version="1">
    <linux:name>redhat-release-client</linux:name>
  </linux:rpminfo_object>
  <ind:variable_test check="all" check_existence="at_least_one_exists" comment="Verify if Value of sshd_required is the default" id="oval:ssg-test_sshd_requirement_unset:tst:1" version="1">
    <ind:object object_ref="oval:ssg-object_sshd_requirement_unknown:obj:1"/>
    <ind:state state_ref="oval:ssg-state_sshd_requirement_unset:ste:1"/>
  </ind:variable_test>
  <unix:file_test check="all" check_existence="all_exist" comment="/etc/debian_version exists" id="oval:ssg-test_debian:tst:1" version="1">
    <unix:object object_ref="oval:ssg-obj_debian:obj:1"/>
  </unix:file_test>
  <ind:variable_state id="oval:ssg-state_sshd_required:ste:1" version="1">
    <ind:value datatype="int" operation="equals">2</ind:value>
  </ind:variable_state>
  <linux:rpminfo_state id="oval:ssg-state_rhel7_server:ste:1" version="1">
    <linux:version operation="pattern match">^7.*$</linux:version>
  </linux:rpminfo_state>
  <ind:variable_test check="all" check_existence="at_least_one_exists" comment="Verify if Profile set Value sshd_required as required" id="oval:ssg-test_sshd_required:tst:1" version="1">
    <ind:object object_ref="oval:ssg-object_sshd_required:obj:1"/>
    <ind:state state_ref="oval:ssg-state_sshd_required:ste:1"/>
  </ind:variable_test>
  <definition class="inventory" id="oval:ssg-installed_OS_is_centos7:def:1" version="2">
    <metadata>
      <title>CentOS 7</title>
      <affected family="unix">
        <platform>Red Hat Enterprise Linux 8</platform>
      </affected>
      <reference ref_id="cpe:/o:centos:centos:7" source="CPE"/>
      <description>The operating system installed on the system is
      CentOS 7</description>
      <reference ref_id="installed_OS_is_centos7" source="ssg"/>
    </metadata>
    <criteria operator="AND">
      <extend_definition comment="Installed OS is part of the Unix family" definition_ref="oval:ssg-installed_OS_is_part_of_Unix_family:def:1"/>
      <criterion comment="CentOS7 is installed" test_ref="oval:ssg-test_centos7:tst:1"/>
    </criteria>
  </definition>
  <linux:rpminfo_test check="all" check_existence="at_least_one_exists" comment="centos-release is version 6" id="oval:ssg-test_centos6:tst:1" version="1">
    <linux:object object_ref="oval:ssg-obj_centos6:obj:1"/>
    <linux:state state_ref="oval:ssg-state_centos6:ste:1"/>
  </linux:rpminfo_test>
  <linux:rpminfo_object id="oval:ssg-obj_sle12_desktop:obj:1" version="1">
    <linux:name>sled-release</linux:name>
  </linux:rpminfo_object>
  <linux:rpminfo_test check="all" check_existence="at_least_one_exists" comment="redhat-release-server is version 7" id="oval:ssg-test_rhel7_server:tst:1" version="1">
    <linux:object object_ref="oval:ssg-obj_rhel7_server:obj:1"/>
    <linux:state state_ref="oval:ssg-state_rhel7_server:ste:1"/>
  </linux:rpminfo_test>
  <ind:textfilecontent54_test check="all" comment="CPE vendor is 'fedoraproject' and 'product' is fedora" id="oval:ssg-test_fedora_vendor_product:tst:1" version="1">
    <ind:object object_ref="oval:ssg-object_fedora_vendor_product:obj:1"/>
  </ind:textfilecontent54_test>
  <definition class="inventory" id="oval:ssg-installed_OS_is_fedora:def:1" version="3">
    <metadata>
      <title>Installed operating system is Fedora</title>
      <affected family="unix">
        <platform>Red Hat Enterprise Linux 8</platform>
      </affected>
      <reference ref_id="cpe:/o:fedoraproject:fedora:28" source="CPE"/>
      <description>The operating system installed on the system is Fedora</description>
      <reference ref_id="installed_OS_is_fedora" source="ssg"/>
    </metadata>
    <criteria operator="AND">
      <extend_definition comment="Installed OS is part of the Unix family" definition_ref="oval:ssg-installed_OS_is_part_of_Unix_family:def:1"/>
      <criterion comment="fedora-release RPM packages are installed" test_ref="oval:ssg-test_fedora_release_rpm:tst:1"/>
      <criterion comment="CPE vendor is 'fedoraproject' and product is 'fedora'" test_ref="oval:ssg-test_fedora_vendor_product:tst:1"/>
    </criteria>
  </definition>
  <definition class="inventory" id="oval:ssg-installed_OS_is_ol8_family:def:1" version="1">
    <metadata>
      <title>Oracle Linux 8</title>
      <affected family="unix">
        <platform>Red Hat Enterprise Linux 8</platform>
      </affected>
      <reference ref_id="cpe:/o:oracle:linux:8" source="CPE"/>
      <description>The operating system installed on the system is
      Oracle Linux 8</description>
      <reference ref_id="installed_OS_is_ol8_family" source="ssg"/>
    </metadata>
    <criteria>
      <extend_definition comment="Installed OS is part of the Unix family" definition_ref="oval:ssg-installed_OS_is_part_of_Unix_family:def:1"/>
      <criteria operator="OR">
        <criterion comment="Oracle Linux 8 System is installed" test_ref="oval:ssg-test_ol8_system:tst:1"/>
      </criteria>
    </criteria>
  </definition>
  <linux:rpminfo_object id="oval:ssg-obj_ol8_system:obj:1" version="1">
    <linux:name>oraclelinux-release</linux:name>
  </linux:rpminfo_object>
  <ind:textfilecontent54_object comment="Check Ubuntu version" id="oval:ssg-obj_ubuntu_xenial:obj:1" version="1">
    <ind:filepath>/etc/lsb-release</ind:filepath>
    <ind:pattern operation="pattern match">^DISTRIB_CODENAME=xenial$</ind:pattern>
    <ind:instance datatype="int">1</ind:instance>
  </ind:textfilecontent54_object>
  <ind:textfilecontent54_test check="all" check_existence="at_least_one_exists" comment="Check Ubuntu version" id="oval:ssg-test_ubuntu_bionic:tst:1" version="1">
    <ind:object object_ref="oval:ssg-obj_ubuntu_bionic:obj:1"/>
  </ind:textfilecontent54_test>
  <ind:textfilecontent54_object comment="Check Ubuntu version" id="oval:ssg-obj_ubuntu_bionic:obj:1" version="1">
    <ind:filepath>/etc/lsb-release</ind:filepath>
    <ind:pattern operation="pattern match">^DISTRIB_CODENAME=bionic$</ind:pattern>
    <ind:instance datatype="int">1</ind:instance>
  </ind:textfilecontent54_object>
  <ind:family_object id="oval:ssg-object_unix_family:obj:1" version="1"/>
  <linux:rpminfo_object id="oval:ssg-obj_package_openssh-server_removed:obj:1" version="1">
    <linux:name>openssh-server</linux:name>
  </linux:rpminfo_object>
  <linux:rpminfo_state id="oval:ssg-state_rhel7_computenode:ste:1" version="1">
    <linux:version operation="pattern match">^7.*$</linux:version>
  </linux:rpminfo_state>
  <ind:family_object id="oval:ssg-obj_sle12_unix_family:obj:1" version="1"/>
  <ind:textfilecontent54_test check="all" comment="RHEVH base RHEL is version 7" id="oval:ssg-test_rhev_rhel_version:tst:1" version="1">
    <ind:object object_ref="oval:ssg-obj_rhevh_rhel_version:obj:1"/>
    <ind:state state_ref="oval:ssg-state_rhevh_rhel_version:ste:1"/>
  </ind:textfilecontent54_test>
  <definition class="inventory" id="oval:ssg-installed_OS_is_rhel6:def:1" version="2">
    <metadata>
      <title>Red Hat Enterprise Linux 6</title>
      <affected family="unix">
        <platform>Red Hat Enterprise Linux 8</platform>
      </affected>
      <reference ref_id="cpe:/o:redhat:enterprise_linux:6" source="CPE"/>
      <description>The operating system installed on the system is
      Red Hat Enterprise Linux 6</description>
      <reference ref_id="installed_OS_is_rhel6" source="ssg"/>
    </metadata>
    <criteria operator="AND">
      <extend_definition comment="Installed OS is part of the Unix family" definition_ref="oval:ssg-installed_OS_is_part_of_Unix_family:def:1"/>
      <criteria operator="OR">
        <criterion comment="RHEL 6 Client is installed" test_ref="oval:ssg-test_rhel_client:tst:1"/>
        <criterion comment="RHEL 6 Workstation is installed" test_ref="oval:ssg-test_rhel_workstation:tst:1"/>
        <criterion comment="RHEL 6 Server is installed" test_ref="oval:ssg-test_rhel_server:tst:1"/>
        <criterion comment="RHEL 6 Compute Node is installed" test_ref="oval:ssg-test_rhel_computenode:tst:1"/>
      </criteria>
    </criteria>
  </definition>
  <linux:rpminfo_test check="all" check_existence="at_least_one_exists" comment="redhat-release-workstation is version 7" id="oval:ssg-test_rhel7_workstation:tst:1" version="1">
    <linux:object object_ref="oval:ssg-obj_rhel7_workstation:obj:1"/>
    <linux:state state_ref="oval:ssg-state_rhel7_workstation:ste:1"/>
  </linux:rpminfo_test>
  <linux:rpminfo_object id="oval:ssg-obj_rhel_computenode:obj:1" version="1">
    <linux:name>redhat-release-computenode</linux:name>
  </linux:rpminfo_object>
  <linux:rpminfo_object id="oval:ssg-obj_rhel_server:obj:1" version="1">
    <linux:name>redhat-release-server</linux:name>
  </linux:rpminfo_object>
  <unix:file_test check="all" check_existence="all_exist" comment="/etc/lsb-release exists" id="oval:ssg-test_lsb:tst:1" version="1">
    <unix:object object_ref="oval:ssg-obj_lsb:obj:1"/>
  </unix:file_test>
  <linux:rpminfo_object id="oval:ssg-obj_opensuse_installed:obj:1" version="1">
    <linux:name>openSUSE-release</linux:name>
  </linux:rpminfo_object>
  <linux:rpminfo_object id="oval:ssg-obj_redhat_release_virtualization_host_rpm:obj:1" version="1">
    <linux:name>redhat-release-virtualization-host</linux:name>
  </linux:rpminfo_object>
  <definition class="inventory" id="oval:ssg-installed_OS_is_ubuntu:def:1" version="1">
    <metadata>
      <title>Ubuntu</title>
      <affected family="unix">
        <platform>Red Hat Enterprise Linux 8</platform>
      </affected>
      <description>The operating system installed is an Ubuntu System</description>
      <reference ref_id="installed_OS_is_ubuntu" source="ssg"/>
    </metadata>
    <criteria comment="System is Ubuntu" operator="AND">
      <extend_definition comment="Installed OS is part of the Unix family" definition_ref="oval:ssg-installed_OS_is_part_of_Unix_family:def:1"/>
      <criterion comment="lsb-based distrib" test_ref="oval:ssg-test_lsb:tst:1"/>
      <criterion comment="Ubuntu is installed" test_ref="oval:ssg-test_ubuntu:tst:1"/>
    </criteria>
  </definition>
  <definition class="inventory" id="oval:ssg-installed_OS_is_rhel7:def:1" version="1">
    <metadata>
      <title>Red Hat Enterprise Linux 7</title>
      <affected family="unix">
        <platform>Red Hat Enterprise Linux 8</platform>
      </affected>
      <reference ref_id="cpe:/o:redhat:enterprise_linux:7" source="CPE"/>
      <description>The operating system installed on the system is
      Red Hat Enterprise Linux 7</description>
      <reference ref_id="installed_OS_is_rhel7" source="ssg"/>
    </metadata>
    <criteria>
      <criterion comment="Installed operating system is part of the unix family" test_ref="oval:ssg-test_rhel7_unix_family:tst:1"/>
      <criteria operator="OR">
        <criterion comment="RHEL 7 Client is installed" test_ref="oval:ssg-test_rhel7_client:tst:1"/>
        <criterion comment="RHEL 7 Workstation is installed" test_ref="oval:ssg-test_rhel7_workstation:tst:1"/>
        <criterion comment="RHEL 7 Server is installed" test_ref="oval:ssg-test_rhel7_server:tst:1"/>
        <criterion comment="RHEL 7 Compute Node is installed" test_ref="oval:ssg-test_rhel7_computenode:tst:1"/>
        <criteria comment="Red Hat Enterpise Virtualization Host is installed" operator="AND">
          <criterion comment="redhat-release-virtualization-host RPM package is installed" test_ref="oval:ssg-test_redhat_release_virtualization_host_rpm:tst:1"/>
          <criterion comment="Red Hat Enterpise Virtualization Host is based on RHEL 7" test_ref="oval:ssg-test_rhev_rhel_version:tst:1"/>
        </criteria>
      </criteria>
    </criteria>
  </definition>
  <definition class="compliance" id="oval:ssg-sshd_required_or_unset:def:1" version="1">
    <metadata>
      <title>SSHD is required to be installed or requirement not set</title>
      <affected family="unix">
        <platform>Red Hat Enterprise Linux 8</platform>
      </affected>
      <description>If SSHD is required, we check it is installed. If SSH requirement is unset, we are good.</description>
      <reference ref_id="sshd_required_or_unset" source="ssg"/>
    </metadata>
    <criteria comment="SSH required or not set" operator="OR">
      <criterion test_ref="oval:ssg-test_sshd_required:tst:1"/>
      <extend_definition comment="SSH requirement is unset" definition_ref="oval:ssg-sshd_requirement_unset:def:1"/>
    </criteria>
  </definition>
  <unix:file_object comment="check /etc/debian_version file" id="oval:ssg-obj_debian:obj:1" version="1">
    <unix:filepath>/etc/debian_version</unix:filepath>
  </unix:file_object>
  <linux:rpminfo_object id="oval:ssg-obj_centos7:obj:1" version="1">
    <linux:name>centos-release</linux:name>
  </linux:rpminfo_object>
  <linux:rpminfo_state id="oval:ssg-state_ol7_system:ste:1" version="1">
    <linux:version operation="pattern match">^7.*$</linux:version>
  </linux:rpminfo_state>
  <ind:family_state id="oval:ssg-state_rhel7_unix_family:ste:1" version="1">
    <ind:family>unix</ind:family>
  </ind:family_state>
  <definition class="compliance" id="oval:ssg-sshd_version_equal_or_higher_than_74:def:1" version="1">
    <metadata>
      <title>OpenSSH Server is 7.4 or newer</title>
      <affected family="unix">
        <platform>Red Hat Enterprise Linux 8</platform>
      </affected>
      <description>Check if version of OpenSSH Server is equal or higher than 7.4</description>
      <reference ref_id="sshd_version_equal_or_higher_than_74" source="ssg"/>
    </metadata>
    <criteria comment="OpenSSH Server version is equal or higher than 7.4" operator="OR">
      <criteria comment="System uses RPM based packages" operator="AND">
        <criteria comment="System uses RPM based packages" operator="OR">
          <extend_definition comment="RHEL7 OS installed" definition_ref="oval:ssg-installed_OS_is_rhel7:def:1"/>
          <extend_definition comment="RHEL6 OS installed" definition_ref="oval:ssg-installed_OS_is_rhel6:def:1"/>
          <extend_definition comment="CentOS7 OS installed" definition_ref="oval:ssg-installed_OS_is_centos7:def:1"/>
          <extend_definition comment="CentOS6 OS installed" definition_ref="oval:ssg-installed_OS_is_centos6:def:1"/>
          <extend_definition comment="Fedora OS installed" definition_ref="oval:ssg-installed_OS_is_fedora:def:1"/>
          <extend_definition comment="openSUSE OS installed" definition_ref="oval:ssg-installed_OS_is_opensuse:def:1"/>
          <extend_definition comment="SLE11 OS installed" definition_ref="oval:ssg-installed_OS_is_sle11:def:1"/>
          <extend_definition comment="SLE12 OS installed" definition_ref="oval:ssg-installed_OS_is_sle12:def:1"/>
          <extend_definition comment="Installed OS is OL7" definition_ref="oval:ssg-installed_OS_is_ol7_family:def:1"/>
          <extend_definition comment="Installed OS is OL8" definition_ref="oval:ssg-installed_OS_is_ol8_family:def:1"/>
        </criteria>
        <criterion comment="Check RPM OpenSSH Server is equal or higher than 7.4" test_ref="oval:ssg-test_rpm_openssh-server_version:tst:1"/>
      </criteria>
      <criteria comment="System uses DEB based packages" operator="AND">
        <criteria comment="System uses RPM based packages" operator="OR">
          <extend_definition comment="Ubuntu 1404 OS installed" definition_ref="oval:ssg-installed_OS_is_ubuntu1404:def:1"/>
          <extend_definition comment="Ubuntu 1604 OS installed" definition_ref="oval:ssg-installed_OS_is_ubuntu1604:def:1"/>
          <extend_definition comment="Ubuntu 1804 OS installed" definition_ref="oval:ssg-installed_OS_is_ubuntu1804:def:1"/>
          <extend_definition comment="Debian 8 OS installed" definition_ref="oval:ssg-installed_OS_is_debian8:def:1"/>
        </criteria>
        <criterion comment="Check DEB version of OpenSSH Server is equal or higher than 7.4" test_ref="oval:ssg-test_deb_openssh-server_version:tst:1"/>
      </criteria>
    </criteria>
  </definition>
  <ind:textfilecontent54_test check="all" check_existence="at_least_one_exists" comment="Check Ubuntu version" id="oval:ssg-test_ubuntu_xenial:tst:1" version="1">
    <ind:object object_ref="oval:ssg-obj_ubuntu_xenial:obj:1"/>
  </ind:textfilecontent54_test>
  <ind:variable_state id="oval:ssg-state_sshd_requirement_unset:ste:1" version="1">
    <ind:value datatype="int" operation="equals">0</ind:value>
  </ind:variable_state>
  <linux:rpminfo_test check="all" check_existence="at_least_one_exists" comment="oraclelinux-release is version 7" id="oval:ssg-test_ol7_system:tst:1" version="1">
    <linux:object object_ref="oval:ssg-obj_ol7_system:obj:1"/>
    <linux:state state_ref="oval:ssg-state_ol7_system:ste:1"/>
  </linux:rpminfo_test>
  <linux:rpminfo_test check="all" check_existence="at_least_one_exists" comment="sles-release is version 6" id="oval:ssg-test_sle11_server:tst:1" version="1">
    <linux:object object_ref="oval:ssg-obj_sle11_server:obj:1"/>
    <linux:state state_ref="oval:ssg-state_sle11_server:ste:1"/>
  </linux:rpminfo_test>
  <ind:textfilecontent54_test check="all" check_existence="at_least_one_exists" comment="Check Ubuntu" id="oval:ssg-test_ubuntu:tst:1" version="1">
    <ind:object object_ref="oval:ssg-obj_ubuntu:obj:1"/>
  </ind:textfilecontent54_test>
  <definition class="compliance" id="oval:ssg-package_openssh-server_removed:def:1" version="1">
    <metadata>
      <title>Package openssh-server Removed</title>
      <affected family="unix">
        <platform>Red Hat Enterprise Linux 8</platform>
      </affected>
      <description>The RPM package openssh-server should be removed.</description>
      <reference ref_id="package_openssh-server_removed" source="ssg"/>
    </metadata>
    <criteria>
      <criterion comment="package openssh-server is removed" test_ref="oval:ssg-test_package_openssh-server_removed:tst:1"/>
    </criteria>
  </definition>
  <ind:family_test check="all" check_existence="at_least_one_exists" comment="installed OS part of unix family" id="oval:ssg-test_sle11_unix_family:tst:1" version="1">
    <ind:object object_ref="oval:ssg-obj_sle11_unix_family:obj:1"/>
    <ind:state state_ref="oval:ssg-state_sle11_unix_family:ste:1"/>
  </ind:family_test>
  <definition class="compliance" id="oval:ssg-package_openssh-server_installed:def:1" version="1">
    <metadata>
      <title>Package openssh-server Installed</title>
      <affected family="unix">
        <platform>Red Hat Enterprise Linux 8</platform>
      </affected>
      <description>The RPM package openssh-server should be installed.</description>
      <reference ref_id="package_openssh-server_installed" source="ssg"/>
    </metadata>
    <criteria>
      <criterion comment="package openssh-server is installed" test_ref="oval:ssg-test_package_openssh-server_installed:tst:1"/>
    </criteria>
  </definition>
  <linux:rpminfo_test check="all" check_existence="at_least_one_exists" comment="redhat-release-computenode is version 7" id="oval:ssg-test_rhel7_computenode:tst:1" version="1">
    <linux:object object_ref="oval:ssg-obj_rhel7_computenode:obj:1"/>
    <linux:state state_ref="oval:ssg-state_rhel7_computenode:ste:1"/>
  </linux:rpminfo_test>
  <linux:rpminfo_test check="all" check_existence="none_exist" comment="package openssh-server is removed" id="oval:ssg-test_package_openssh-server_removed:tst:1" version="1">
    <linux:object object_ref="oval:ssg-obj_package_openssh-server_removed:obj:1"/>
  </linux:rpminfo_test>
  <linux:rpminfo_object id="oval:ssg-object_fedora_release_rpm:obj:1" version="1">
    <linux:name operation="pattern match">fedora-release.*</linux:name>
  </linux:rpminfo_object>
  <ind:textfilecontent54_object comment="Check Ubuntu" id="oval:ssg-obj_ubuntu:obj:1" version="1">
    <ind:filepath>/etc/lsb-release</ind:filepath>
    <ind:pattern operation="pattern match">^DISTRIB_ID=Ubuntu$</ind:pattern>
    <ind:instance datatype="int">1</ind:instance>
  </ind:textfilecontent54_object>
  <ind:textfilecontent54_test check="all" check_existence="at_least_one_exists" comment="Check Debian version" id="oval:ssg-test_debian_8:tst:1" version="1">
    <ind:object object_ref="oval:ssg-obj_debian_8:obj:1"/>
  </ind:textfilecontent54_test>
  <linux:rpminfo_state id="oval:ssg-state_sle12_desktop:ste:1" version="1">
    <linux:version operation="pattern match">^12.*$</linux:version>
  </linux:rpminfo_state>
  <linux:rpminfo_test check="all" check_existence="at_least_one_exists" comment="sled-release is version 6" id="oval:ssg-test_sle12_desktop:tst:1" version="1">
    <linux:object object_ref="oval:ssg-obj_sle12_desktop:obj:1"/>
    <linux:state state_ref="oval:ssg-state_sle12_desktop:ste:1"/>
  </linux:rpminfo_test>
  <linux:rpminfo_object id="oval:ssg-obj_rhel7_workstation:obj:1" version="1">
    <linux:name>redhat-release-workstation</linux:name>
  </linux:rpminfo_object>
  <linux:rpminfo_state id="oval:ssg-state_rpm_openssh-server-version:ste:1" version="1">
    <linux:evr datatype="evr_string" operation="greater than or equal">0:7.4</linux:evr>
  </linux:rpminfo_state>
  <linux:rpminfo_test check="all" check_existence="at_least_one_exists" comment="redhat-release-client is version 6" id="oval:ssg-test_rhel_client:tst:1" version="1">
    <linux:object object_ref="oval:ssg-obj_rhel_client:obj:1"/>
    <linux:state state_ref="oval:ssg-state_rhel_client:ste:1"/>
  </linux:rpminfo_test>
  <ind:textfilecontent54_object comment="Check Debian version" id="oval:ssg-obj_debian_8:obj:1" version="1">
    <ind:filepath>/etc/debian_version</ind:filepath>
    <ind:pattern operation="pattern match">^8.[0-9]+$</ind:pattern>
    <ind:instance datatype="int">1</ind:instance>
  </ind:textfilecontent54_object>
  <ind:family_state id="oval:ssg-state_unix_family:ste:1" version="1">
    <ind:family>unix</ind:family>
  </ind:family_state>
  <linux:rpminfo_object id="oval:ssg-obj_rhel_workstation:obj:1" version="1">
    <linux:name>redhat-release-workstation</linux:name>
  </linux:rpminfo_object>
  <linux:rpminfo_state id="oval:ssg-state_sle11_desktop:ste:1" version="1">
    <linux:version operation="pattern match">^11.*$</linux:version>
  </linux:rpminfo_state>
</def-group>